#!/usr/bin/env php
<?php declare(strict_types = 1);

$autoloaderInWorkingDirectory = getcwd() . '/vendor/autoload.php';
if (is_file($autoloaderInWorkingDirectory)) {
  require_once($autoloaderInWorkingDirectory);
}
if (!class_exists('PHPStan\Command\AnalyseCommand', true)) {
  $composerAutoloadFile = __DIR__ . '/../vendor/autoload.php';
  if (!is_file($composerAutoloadFile)) {
    $composerAutoloadFile = __DIR__ . '/../../../autoload.php';
  }
  require_once($composerAutoloadFile);
}

$loader = new Nette\DI\ContainerLoader(__DIR__ . '/../../../../temp');
$class = $loader->load(function(\Nette\DI\Compiler $compiler) {
  $compiler->loadConfig(__DIR__ . '/../../../../src/config.neon');
});
/** @var \Nette\DI\Container $container */
$container = new $class;

// Create the Application
$application = $container->getByType(Symfony\Component\Console\Application::class);

// Register all Commands
$application->add($container->getByType(\Oli\EmailSender\Cron\Commands\SendEmailsCommand::class));

// Run it
$application->run();
